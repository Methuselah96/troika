/*!
Custom bundle of @unicode-font-resolver/client v0.3.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/
export default function(){return function(t){"use strict";var n=function(){this.buckets=new Map};n.prototype.add=function(t){var n=t>>5;this.buckets.set(n,(this.buckets.get(n)||0)|1<<(31&t))},n.prototype.has=function(t){var n=this.buckets.get(t>>5);return void 0!==n&&0!=(n&1<<(31&t))},n.prototype.serialize=function(){var t=[];return this.buckets.forEach((function(n,r){t.push((+r).toString(36)+":"+n.toString(36))})),t.join(",")},n.prototype.deserialize=function(t){var n=this;this.buckets.clear(),t.split(",").forEach((function(t){var r=t.split(":");n.buckets.set(parseInt(r[0],36),parseInt(r[1],36))}))};var r=Math.pow(2,8),e=r-1,o=~e;function i(t){var n=function(t){return t&o}(t).toString(16),e=function(t){return(t&o)+r-1}(t).toString(16);return"codepoint-index/plane"+(t>>16)+"/"+n+"-"+e+".json"}function a(t,n){var r=t&e,o=n.codePointAt(r/6|0);return 0!=((o=(o||48)-48)&1<<r%6)}function u(t,n){var r;(r=t,r.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(t){return t.split("-").map((function(t){return parseInt(t.trim(),16)}))}))).forEach((function(t){var r=t[0],e=t[1];void 0===e&&(e=r),n(r,e)}))}function s(t,n){u(t,(function(t,r){for(var e=t;e<=r;e++)n(e)}))}var c={},f={},v=new WeakMap;function l(t){var r=v.get(t);return r||(r=new n,s(t.ranges,(function(t){return r.add(t)})),v.set(t,r)),r}var d,h=new Map;function p(t){var n=h.get(t);return n||(n=fetch(t).then((function(t){return t.json()})),h.set(t,n)),n}function g(t,n,r){return t[n]?n:t[r]?r:function(t){for(var n in t)return n}(t)}function w(t,n){var r=n;if(!t.includes(r)){r=1/0;for(var e=0;e<t.length;e++)Math.abs(t[e]-n)<Math.abs(r-n)&&(r=t[e])}return r}function b(t){return d||(d=new Set,s("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(t){d.add(t)}))),d.has(t)}return t.CodePointSet=n,t.clearCache=function(){c={},f={}},t.getFontsForString=function(t,n){void 0===n&&(n={});var r=n.lang;void 0===r&&(r="en");var e=n.category;void 0===e&&(e="sans-serif");var o=n.style;void 0===o&&(o="normal");var u=n.weight;void 0===u&&(u=400);for(var s=(n.dataUrl||"https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v0.3.2/packages/data").replace(/\/$/g,""),v=new Map,d=new Uint8Array(t.length),h={},y={},k=new Array(t.length),m=new Map,A=function(n){var r=t.codePointAt(n),e=i(r);k[n]=e,c[e]||m.has(e)||m.set(e,p(s+"/"+e).then((function(t){c[e]=t}))),r>65535&&(n++,M=n)},M=0;M<t.length;M++)A(M);return Promise.all(m.values()).then((function(){m.clear();for(var n=function(n){var o=t.codePointAt(n),i=null,u=c[k[n]];t:for(var v in u){var l=y[v];if(void 0===l&&(l=y[v]=new RegExp(v).test(r)),l)for(var d in u[v])if(a(o,u[v][d])){i=d;break t}}i||(console.debug("No font coverage for U+"+o.toString(16)),i="latin"),k[n]=i,f[i]||m.has(i)||m.set(i,p(s+"/font-meta/"+i+".json").then((function(t){f[i]=t}))),o>65535&&(n++,e=n)},e=0;e<t.length;e++)n(e);return Promise.all(m.values())})).then((function(){for(var n,r=null,i=0;i<t.length;i++){var a=t.codePointAt(i);if(r&&(b(a)||l(r).has(a)))d[i]=d[i-1];else{r=f[k[i]];var c=h[r.id];if(!c){var p=r.typeforms,y=g(p,e,"sans-serif"),m=g(p[y],o,"normal"),A=w(null===(n=p[y])||void 0===n?void 0:n[m],u);c=h[r.id]=s+"/font-files/"+r.id+"/"+y+"."+m+"."+A+".woff"}var M=v.get(c);null==M&&(M=v.size,v.set(c,M)),d[i]=M}a>65535&&(i++,d[i]=d[i-1])}return{fontUrls:Array.from(v.keys()),chars:d}}))},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}
